const db = require('./src/models');

async function optimizeKeywords() {
  try {
    console.log('🚀 开始优化核心意图关键词...');
    
    await db.sequelize.authenticate();
    console.log('✅ 数据库连接成功');

    // 获取所有核心意图
    const coreIntents = await db.CoreIntent.findAll({
      order: [['categoryId', 'ASC'], ['id', 'ASC']]
    });

    console.log(`📊 发现 ${coreIntents.length} 个核心意图需要优化关键词`);

    // 定义优化的关键词映射
    const keywordOptimizations = {
      // === 音乐控制类 (categoryId: 1) ===
      '播放音乐': [
        '播放', '放', '来一首', '听', '音乐', '歌', '播放歌曲', '放首歌', '听音乐', 
        '我想听歌', '来首歌', '播放音乐', '放音乐', '听歌', '播放歌曲', '音乐播放'
      ],
      '暂停音乐': [
        '暂停', '停', '停止', '别播了', '暂停播放', '停止播放', '先停一下', 
        '暂停音乐', '停止音乐', '别放了', '暂停一下', '停止一下'
      ],
      '音乐播放控制': [
        '播放歌曲', '放音乐', '听歌', '音乐控制', '播放列表', '音乐播放', 
        '播放控制', '音乐管理', '播放管理', '音乐操作'
      ],
      '音量调节': [
        '调节音量', '声音大小', '音量', '大声点', '小声点', '调音量', 
        '音量调节', '声音调节', '调大声音', '调小声音', '音量控制'
      ],
      '音乐搜索': [
        '找歌', '搜索音乐', '播放歌手', '找歌曲', '音乐搜索', '搜索歌曲', 
        '查找音乐', '找音乐', '音乐查找', '搜索歌手'
      ],
      '下一首': [
        '下一首', '切歌', '换一首', '下首歌', '跳过这首', '下一首歌曲', 
        '切换歌曲', '下一首歌', '播放下一首', '下一曲'
      ],
      '上一首': [
        '上一首', '前一首', '回到上首', '上首歌', '上一首歌曲', 
        '播放上一首', '上一首歌', '前一首歌', '回到上一首'
      ],
      '静音': [
        '静音', '关闭声音', '取消静音', '恢复声音', '静音模式', 
        '关闭音频', '取消静音模式', '恢复音频', '静音开关'
      ],
      '播放模式': [
        '播放模式', '循环模式', '顺序播放', '随机模式', '播放方式', 
        '循环播放', '顺序模式', '随机播放', '播放设置'
      ],
      '音乐暂停': [
        '暂停', '停止播放', '暂停音乐', '停一下', '暂停播放', 
        '停止音乐', '暂停一下', '停止一下', '暂停歌曲'
      ],
      '音乐继续': [
        '继续播放', '继续', '恢复播放', '播放', '继续音乐', 
        '恢复音乐', '继续歌曲', '恢复歌曲', '继续播放音乐'
      ],
      '播放歌手': [
        '播放歌手', '听歌手', '歌手的歌', '某某歌手', '播放某某歌手', 
        '听某某歌手', '歌手的歌曲', '播放歌手的歌', '歌手音乐'
      ],
      '播放类型': [
        '播放类型', '音乐类型', '流行音乐', '摇滚音乐', '播放流行音乐', 
        '播放摇滚音乐', '音乐风格', '播放风格', '类型音乐'
      ],
      '音乐推荐': [
        '推荐音乐', '音乐推荐', '好听的歌', '推荐歌曲', '推荐好音乐', 
        '推荐好歌', '音乐推荐', '歌曲推荐', '推荐好听的歌'
      ],

      // === 天气查询类 (categoryId: 2) ===
      '查询天气': [
        '天气', '气温', '温度', '下雨', '晴天', '天气怎么样', '今天天气', 
        '天气情况', '天气状况', '天气信息', '天气查询'
      ],
      '天气预报查询': [
        '明天天气', '后天天气', '天气预报', '未来天气', '下周天气', 
        '天气预报查询', '未来天气预报', '天气预测', '天气预告'
      ],
      '实时天气': [
        '现在天气', '当前天气', '今天天气怎么样', '外面天气', '实时天气', 
        '此刻天气', '现在天气怎么样', '当前天气情况', '实时天气信息'
      ],
      '明天天气': [
        '明天天气', '明日天气', '明天怎么样', '明天温度', '明天天气预报', 
        '明天天气怎么样', '明天天气情况', '明日天气预报'
      ],
      '后天天气': [
        '后天天气', '后天怎么样', '大后天天气', '后天天气预报', 
        '后天天气怎么样', '后天天气情况', '大后天天气预报'
      ],
      '一周天气': [
        '一周天气', '七天天气', '本周天气', '天气预报', '一周天气预报', 
        '七天天气预报', '本周天气预报', '一周天气情况'
      ],
      '空气质量': [
        '空气质量', 'PM2.5', '雾霾', '污染指数', '空气怎么样', '空气质量指数', 
        '空气污染', 'PM2.5指数', '空气质量情况', '空气状况'
      ],
      '紫外线指数': [
        '紫外线', '紫外线指数', '需要防晒吗', '阳光强度', '紫外线强度', 
        '防晒指数', '紫外线情况', '阳光怎么样', '紫外线指数查询'
      ],
      '降雨概率': [
        '会下雨吗', '降雨概率', '下雨可能性', '需要带伞吗', '下雨概率', 
        '降雨可能性', '下雨机会', '带伞建议', '降雨预报'
      ],
      '风力风向': [
        '风力', '风向', '风速', '有风吗', '风大吗', '风力风向', 
        '风向风力', '风速风向', '风力情况', '风向情况'
      ],
      '湿度查询': [
        '湿度', '空气湿度', '干燥吗', '潮湿吗', '湿度查询', '空气湿度查询', 
        '湿度情况', '空气干燥', '空气潮湿', '湿度指数'
      ],
      '气压查询': [
        '气压', '大气压', '气压高低', '气压查询', '大气压力', 
        '气压情况', '气压指数', '大气压查询', '气压高低查询'
      ],
      '日出日落': [
        '日出时间', '日落时间', '几点天亮', '几点天黑', '日出日落', 
        '日出日落时间', '天亮时间', '天黑时间', '日出时间查询'
      ],
      '穿衣建议': [
        '穿什么衣服', '穿衣建议', '今天穿什么', '穿衣指导', '穿衣服建议', 
        '今天穿什么衣服', '穿衣推荐', '穿衣服指导', '穿衣搭配'
      ],
      '外出建议': [
        '适合外出吗', '出门建议', '户外活动', '运动建议', '外出建议', 
        '出门指导', '户外活动建议', '运动指导', '外出活动'
      ],
      '温度查询': [
        '温度', '气温', '多少度', '冷不冷', '热不热', '温度查询', 
        '气温查询', '温度多少', '气温多少', '温度情况'
      ],
      '天气趋势': [
        '天气趋势', '天气变化', '未来天气', '天气走势', '天气趋势查询', 
        '天气变化趋势', '未来天气趋势', '天气走势查询'
      ],
      '季节天气': [
        '春天天气', '夏天天气', '秋天天气', '冬天天气', '季节天气', 
        '春季天气', '夏季天气', '秋季天气', '冬季天气', '季节天气特点'
      ],
      '极端天气': [
        '台风', '暴雨', '大雪', '高温', '寒潮', '极端天气', 
        '台风天气', '暴雨天气', '大雪天气', '高温天气', '寒潮天气'
      ],
      '地区天气': [
        '北京天气', '上海天气', '广州天气', '地区天气', '城市天气', 
        '北京天气预报', '上海天气预报', '广州天气预报', '地区天气预报'
      ],
      '天气对比': [
        '天气对比', '天气比较', '哪里天气好', '温差', '天气对比查询', 
        '天气比较查询', '天气好坏', '温差查询', '天气差异'
      ],
      '天气历史': [
        '历史天气', '去年天气', '以前的天气', '天气记录', '天气历史查询', 
        '历史天气查询', '往年天气', '天气历史记录', '历史天气情况'
      ],
      '天气统计': [
        '天气统计', '平均温度', '天气分析', '气候统计', '天气统计分析', 
        '平均气温', '天气数据分析', '气候分析', '天气统计信息'
      ],
      '天气提醒': [
        '天气提醒', '天气变化提醒', '降雨提醒', '温度提醒', '天气预警提醒', 
        '天气变化通知', '降雨通知', '温度变化提醒', '天气提醒设置'
      ],
      '天气分享': [
        '分享天气', '天气分享', '告诉别人天气', '天气信息分享', '分享天气信息', 
        '天气分享给朋友', '告诉朋友天气', '天气信息传播', '天气分享功能'
      ],
      '天气预警': [
        '天气预警', '气象预警', '预警信息', '天气警报', '天气预警信息', 
        '气象预警信息', '预警通知', '天气警报信息', '预警提醒'
      ],

      // === 智能家居类 (categoryId: 3) ===
      '开灯': [
        '开灯', '开', '亮', '灯', '打开灯', '开灯', '灯亮', '开灯开关', 
        '打开灯光', '灯开启', '开灯控制', '灯打开'
      ],
      '关灯': [
        '关灯', '关闭灯', '熄灯', '关灯', '灯关', '关闭灯光', '灯关闭', 
        '关灯开关', '关闭灯', '灯熄灭', '关灯控制', '灯关闭'
      ],
      '开关窗帘': [
        '开窗帘', '关窗帘', '窗帘控制', '拉开窗帘', '关闭窗帘', '窗帘开关', 
        '窗帘打开', '窗帘关闭', '窗帘控制', '窗帘操作', '窗帘调节'
      ],
      '空调温度': [
        '空调温度', '调到多少度', '制冷', '制热', '温度调节', '空调温度调节', 
        '空调制冷', '空调制热', '温度设置', '空调温度设置', '温度调节'
      ],
      '空调模式': [
        '空调模式', '制冷模式', '制热模式', '除湿模式', '送风模式', '空调模式切换', 
        '制冷模式', '制热模式', '除湿模式', '送风模式', '模式切换'
      ],
      '电视控制': [
        '开电视', '关电视', '换台', '调频道', '电视音量', '电视控制', 
        '电视开关', '频道切换', '电视音量调节', '电视操作', '电视管理'
      ],
      '灯光亮度': [
        '灯光亮度', '调亮一点', '调暗一点', '灯光调节', '亮度调节', 
        '灯光亮度调节', '调亮', '调暗', '亮度控制', '灯光亮度控制'
      ],
      '灯光颜色': [
        '灯光颜色', '红色灯光', '蓝色灯光', '彩色灯光', '灯光颜色调节', 
        '红色灯', '蓝色灯', '彩色灯', '颜色调节', '灯光颜色控制'
      ],
      '扫地机器人': [
        '扫地机器人', '开始扫地', '停止扫地', '回充电', '扫地机器人控制', 
        '开始清扫', '停止清扫', '机器人充电', '扫地机', '清扫机器人'
      ],
      '加湿器控制': [
        '开加湿器', '关加湿器', '加湿器档位', '湿度调节', '加湿器控制', 
        '加湿器开关', '加湿器档位调节', '湿度控制', '加湿器操作'
      ],
      '空气净化器': [
        '空气净化器', '净化器开关', '净化器档位', '空气净化', '净化器控制', 
        '空气净化器开关', '净化器档位调节', '空气净化控制', '净化器操作'
      ],
      '热水器控制': [
        '热水器', '热水器温度', '烧热水', '热水器开关', '热水器控制', 
        '热水器温度调节', '烧水', '热水器操作', '热水器管理', '热水器设置'
      ],
      '洗衣机控制': [
        '洗衣机', '开始洗衣', '洗衣程序', '洗衣机状态', '洗衣机控制', 
        '开始洗衣服', '洗衣模式', '洗衣机操作', '洗衣机管理', '洗衣程序设置'
      ],
      '冰箱控制': [
        '冰箱温度', '冰箱模式', '冰箱状态', '冰箱控制', '冰箱温度调节', 
        '冰箱模式设置', '冰箱状态查询', '冰箱操作', '冰箱管理', '冰箱设置'
      ],
      '门锁控制': [
        '门锁', '开门', '锁门', '门锁状态', '门锁控制', '智能门锁', 
        '门锁开关', '门锁状态查询', '门锁操作', '门锁管理', '门锁设置'
      ],
      '安防监控': [
        '监控', '摄像头', '安防状态', '查看监控', '安防监控', '监控摄像头', 
        '安防系统', '监控查看', '摄像头查看', '安防状态查询', '监控状态'
      ],
      '场景模式': [
        '回家模式', '离家模式', '睡眠模式', '聚会模式', '场景切换', '智能场景', 
        '回家场景', '离家场景', '睡眠场景', '聚会场景', '场景模式切换'
      ],
      '风扇控制': [
        '开风扇', '关风扇', '风扇档位', '风扇速度', '风扇控制', '风扇开关', 
        '风扇档位调节', '风扇速度调节', '风扇操作', '风扇管理', '风扇设置'
      ],
      '音响控制': [
        '开音响', '关音响', '音响音量', '音响模式', '音响控制', '音响开关', 
        '音响音量调节', '音响模式切换', '音响操作', '音响管理', '音响设置'
      ],
      '投影仪控制': [
        '开投影仪', '关投影仪', '投影仪亮度', '投影模式', '投影仪控制', 
        '投影仪开关', '投影仪亮度调节', '投影模式切换', '投影仪操作', '投影仪管理'
      ],
      '智能插座': [
        '智能插座', '插座开关', '插座控制', '电源开关', '插座控制', 
        '智能插座开关', '插座操作', '电源控制', '插座管理', '插座设置'
      ],
      '温控器': [
        '温控器', '温度控制', '恒温', '温控设置', '温控器控制', 
        '温度控制器', '恒温控制', '温控器设置', '温控器操作', '温控器管理'
      ],
      '智能门铃': [
        '门铃', '智能门铃', '门铃设置', '门铃状态', '门铃控制', 
        '门铃开关', '门铃设置', '门铃状态查询', '门铃操作', '门铃管理'
      ],
      '烟雾报警器': [
        '烟雾报警器', '火警', '烟雾检测', '安全报警', '烟雾报警器状态', 
        '火警报警', '烟雾检测器', '安全报警器', '烟雾报警器查询', '安全状态'
      ],
      '窗户控制': [
        '开窗', '关窗', '窗户控制', '通风', '窗户开关', '窗户打开', 
        '窗户关闭', '窗户控制', '通风控制', '窗户操作', '窗户管理'
      ],
      '地暖控制': [
        '地暖', '地暖开关', '地暖温度', '地暖模式', '地暖控制', 
        '地暖系统', '地暖温度调节', '地暖模式设置', '地暖操作', '地暖管理'
      ],
      '设备状态': [
        '设备状态', '家电状态', '设备是否开启', '设备运行状态', '设备状态查询', 
        '家电状态查询', '设备开启状态', '设备运行情况', '设备状态检查'
      ],
      '能耗查询': [
        '能耗', '电量', '用电量', '设备耗电', '电费', '能耗查询', 
        '电量查询', '用电量查询', '设备耗电量', '电费查询', '能耗统计'
      ],
      '设备定时': [
        '设备定时', '定时开关', '自动控制', '定时任务', '设备定时设置', 
        '定时开关设置', '自动控制设置', '定时任务设置', '设备定时控制'
      ],
      '设备联动': [
        '设备联动', '自动化', '智能联动', '设备协同', '设备联动设置', 
        '自动化设置', '智能联动设置', '设备协同设置', '设备联动控制'
      ],
      '设备维护': [
        '设备维护', '保养提醒', '维修', '设备检查', '设备维护提醒', 
        '保养提醒', '维修提醒', '设备检查提醒', '设备维护管理', '设备保养'
      ],

      // === 时间日期类 (categoryId: 4) ===
      '时间查询': [
        '现在几点', '时间', '几点了', '当前时间', '时间查询', '现在时间', 
        '当前几点', '时间是多少', '现在时间是多少', '时间信息'
      ],
      '日期查询': [
        '今天几号', '日期', '星期几', '几月几日', '日期查询', '今天日期', 
        '今天是几号', '今天星期几', '日期信息', '今天是什么日子'
      ],
      '闹钟设置': [
        '设置闹钟', '定闹钟', '明天几点叫我', '闹钟提醒', '闹钟设置', 
        '设置闹铃', '定闹铃', '闹钟定时', '闹钟提醒设置', '闹钟管理'
      ],
      '闹钟取消': [
        '取消闹钟', '关闭闹钟', '删除闹钟', '不要闹钟', '闹钟取消', 
        '取消闹铃', '关闭闹铃', '删除闹铃', '不要闹铃', '闹钟删除'
      ],
      '提醒设置': [
        '设置提醒', '提醒我', '记得提醒', '定时提醒', '提醒设置', 
        '设置提醒', '提醒功能', '定时提醒设置', '提醒管理', '提醒功能设置'
      ],
      '提醒取消': [
        '取消提醒', '删除提醒', '不要提醒了', '提醒取消', '取消提醒设置', 
        '删除提醒设置', '不要提醒', '提醒删除', '提醒功能取消'
      ],
      '日程查询': [
        '日程', '日程安排', '今天安排', '明天安排', '日程查询', '日程管理', 
        '日程安排查询', '今天日程', '明天日程', '日程信息', '日程查看'
      ],
      '计时器': [
        '计时器', '定时器', '计时', '定时', '计时器设置', '定时器设置', 
        '计时功能', '定时功能', '计时器管理', '定时器管理'
      ],
      '时区转换': [
        '时区', '时区转换', '时差计算', '不同时区', '时区转换查询', 
        '时差计算查询', '不同时区查询', '时区信息', '时差信息', '时区计算'
      ],
      '日历查询': [
        '日历', '万年历', '日历查询', '日期计算', '日历信息', '万年历查询', 
        '日历查看', '日期计算查询', '日历管理', '日历功能'
      ],
      '重要日期': [
        '重要日期', '纪念日', '生日', '节日', '重要日期查询', '纪念日查询', 
        '生日查询', '节日查询', '重要日期管理', '纪念日管理'
      ],
      '时间段查询': [
        '上午', '下午', '晚上', '凌晨', '时间段', '时间段查询', '上午时间', 
        '下午时间', '晚上时间', '凌晨时间', '时间段信息'
      ],
      '世界时间': [
        '世界时间', '纽约时间', '东京时间', '伦敦时间', '时差', '世界时间查询', 
        '纽约时间查询', '东京时间查询', '伦敦时间查询', '时差查询'
      ],
      '农历查询': [
        '农历', '阴历', '农历几月几日', '今天农历', '农历查询', '阴历查询', 
        '农历日期', '阴历日期', '农历信息', '阴历信息', '农历转换'
      ],
      '节假日查询': [
        '节假日', '假期', '放假', '调休', '法定节假日', '节假日查询', 
        '假期查询', '放假查询', '调休查询', '法定节假日查询', '节假日信息'
      ],
      '倒计时': [
        '倒计时', '计时', '定时', '倒数', '倒计时设置', '计时设置', 
        '定时设置', '倒数设置', '倒计时功能', '计时功能'
      ],
      '秒表': [
        '秒表', '计时器', '开始计时', '停止计时', '秒表功能', '计时器功能', 
        '开始计时', '停止计时', '秒表管理', '计时器管理'
      ],
      '工作日查询': [
        '工作日', '上班日', '今天上班吗', '工作日查询', '工作日信息', 
        '上班日查询', '今天是否上班', '工作日检查', '工作日状态'
      ],
      '生肖查询': [
        '生肖', '属相', '今年属什么', '生肖运势', '生肖查询', '属相查询', 
        '今年生肖', '生肖信息', '属相信息', '生肖运势查询'
      ],
      '星座查询': [
        '星座', '什么座', '星座运势', '星座配对', '星座查询', '星座信息', 
        '星座运势查询', '星座配对查询', '星座分析', '星座特点'
      ],
      '时间计算': [
        '时间计算', '时间间隔', '多长时间', '时间差', '时间计算查询', 
        '时间间隔计算', '多长时间计算', '时间差计算', '时间计算功能'
      ],
      '时间提醒': [
        '时间提醒', '按时提醒', '定时提醒', '时间到了提醒', '时间提醒设置', 
        '按时提醒设置', '定时提醒设置', '时间提醒功能', '时间提醒管理'
      ],
      '时间记录': [
        '时间记录', '记录时间', '时间日志', '时间统计', '时间记录功能', 
        '记录时间功能', '时间日志功能', '时间统计功能', '时间记录管理'
      ],
      '时间规划': [
        '时间规划', '时间安排', '时间管理', '时间分配', '时间规划功能', 
        '时间安排功能', '时间管理功能', '时间分配功能', '时间规划管理'
      ],

      // === 新闻资讯类 (categoryId: 5) ===
      '头条新闻': [
        '头条新闻', '今日头条', '重要新闻', '新闻头条', '头条新闻查询', 
        '今日头条查询', '重要新闻查询', '新闻头条查询', '头条新闻播报'
      ],
      '财经新闻': [
        '财经新闻', '股市', '金融', '经济新闻', '财经资讯', '财经新闻查询', 
        '股市新闻', '金融新闻', '经济资讯', '财经新闻播报', '股市资讯'
      ],
      '体育新闻': [
        '体育新闻', '体育赛事', '球赛', '比赛结果', '体育资讯', '体育新闻查询', 
        '体育赛事查询', '球赛新闻', '比赛结果查询', '体育新闻播报'
      ],
      '科技新闻': [
        '科技新闻', '科技资讯', '数码', '互联网', '科技动态', '科技新闻查询', 
        '科技资讯查询', '数码新闻', '互联网新闻', '科技新闻播报'
      ],
      '娱乐新闻': [
        '娱乐新闻', '明星', '娱乐圈', '影视', '娱乐资讯', '娱乐新闻查询', 
        '明星新闻', '娱乐圈新闻', '影视新闻', '娱乐新闻播报'
      ],
      '国际新闻': [
        '国际新闻', '国外新闻', '世界新闻', '国际资讯', '国际新闻查询', 
        '国外新闻查询', '世界新闻查询', '国际资讯查询', '国际新闻播报'
      ],
      '本地新闻': [
        '本地新闻', '当地新闻', '本市新闻', '本地资讯', '本地新闻查询', 
        '当地新闻查询', '本市新闻查询', '本地资讯查询', '本地新闻播报'
      ],
      '社会新闻': [
        '社会新闻', '民生', '社会热点', '社会资讯', '社会新闻查询', 
        '民生新闻', '社会热点新闻', '社会资讯查询', '社会新闻播报'
      ],
      '实时新闻': [
        '实时新闻', '最新消息', '即时新闻', '最新资讯', '实时新闻查询', 
        '最新消息查询', '即时新闻查询', '最新资讯查询', '实时新闻播报'
      ],
      '新闻摘要': [
        '新闻摘要', '新闻概要', '新闻简报', '新闻总结', '新闻摘要查询', 
        '新闻概要查询', '新闻简报查询', '新闻总结查询', '新闻摘要播报'
      ],
      '热点新闻': [
        '热点新闻', '热门新闻', '热点话题', '热门话题', '热点新闻查询', 
        '热门新闻查询', '热点话题查询', '热门话题查询', '热点新闻播报'
      ],
      '军事新闻': [
        '军事新闻', '军事资讯', '国防', '军事动态', '军事新闻查询', 
        '军事资讯查询', '国防新闻', '军事动态查询', '军事新闻播报'
      ],
      '政治新闻': [
        '政治新闻', '政治资讯', '政策', '政府新闻', '政治新闻查询', 
        '政治资讯查询', '政策新闻', '政府新闻查询', '政治新闻播报'
      ],
      '环境新闻': [
        '环境新闻', '环保', '生态', '环境保护', '环境新闻查询', 
        '环保新闻', '生态新闻', '环境保护新闻', '环境新闻播报'
      ],
      '教育新闻': [
        '教育新闻', '教育资讯', '学校', '教育政策', '教育新闻查询', 
        '教育资讯查询', '学校新闻', '教育政策新闻', '教育新闻播报'
      ],
      '健康新闻': [
        '健康新闻', '医疗', '健康资讯', '医学新闻', '健康新闻查询', 
        '医疗新闻', '健康资讯查询', '医学新闻查询', '健康新闻播报'
      ],
      '汽车新闻': [
        '汽车新闻', '汽车资讯', '车市', '新车发布', '汽车新闻查询', 
        '汽车资讯查询', '车市新闻', '新车发布新闻', '汽车新闻播报'
      ],
      '房产新闻': [
        '房产新闻', '楼市', '房价', '房地产', '房产新闻查询', 
        '楼市新闻', '房价新闻', '房地产新闻', '房产新闻播报'
      ],
      '旅游新闻': [
        '旅游新闻', '旅游资讯', '景点', '旅游攻略', '旅游新闻查询', 
        '旅游资讯查询', '景点新闻', '旅游攻略新闻', '旅游新闻播报'
      ],
      '美食新闻': [
        '美食新闻', '美食资讯', '餐饮', '美食推荐', '美食新闻查询', 
        '美食资讯查询', '餐饮新闻', '美食推荐新闻', '美食新闻播报'
      ],
      '新闻搜索': [
        '新闻搜索', '搜索新闻', '查找新闻', '新闻查询', '新闻搜索功能', 
        '搜索新闻功能', '查找新闻功能', '新闻查询功能', '新闻搜索管理'
      ],
      '新闻订阅': [
        '新闻订阅', '订阅资讯', '关注新闻', '新闻推送', '新闻订阅功能', 
        '订阅资讯功能', '关注新闻功能', '新闻推送功能', '新闻订阅管理'
      ],
      '新闻评论': [
        '新闻评论', '评论新闻', '新闻观点', '新闻看法', '新闻评论功能', 
        '评论新闻功能', '新闻观点功能', '新闻看法功能', '新闻评论管理'
      ],
      '新闻分类': [
        '新闻分类', '分类新闻', '新闻类别', '按类别看新闻', '新闻分类功能', 
        '分类新闻功能', '新闻类别功能', '按类别看新闻功能', '新闻分类管理'
      ],
      '新闻收藏': [
        '新闻收藏', '收藏资讯', '保存新闻', '新闻书签', '新闻收藏功能', 
        '收藏资讯功能', '保存新闻功能', '新闻书签功能', '新闻收藏管理'
      ]
    };

    let updatedCount = 0;
    let skippedCount = 0;

    // 遍历所有核心意图，优化关键词
    for (const intent of coreIntents) {
      const intentName = intent.name;
      const optimizedKeywords = keywordOptimizations[intentName];
      
      if (optimizedKeywords) {
        // 检查当前关键词格式
        let currentKeywords = intent.keywords;
        let isJsonFormat = false;
        
        try {
          if (typeof currentKeywords === 'string' && currentKeywords.startsWith('[')) {
            currentKeywords = JSON.parse(currentKeywords);
            isJsonFormat = true;
          }
        } catch (e) {
          // 如果不是JSON格式，按逗号分割
          currentKeywords = currentKeywords.split(',').map(k => k.trim());
        }

        // 合并现有关键词和优化关键词，去重
        const allKeywords = [...new Set([...currentKeywords, ...optimizedKeywords])];
        
        // 更新数据库
        await db.CoreIntent.update(
          { 
            keywords: JSON.stringify(allKeywords),
            updatedAt: new Date()
          },
          { 
            where: { id: intent.id } 
          }
        );
        
        updatedCount++;
        console.log(`✅ 已优化: ${intentName} (${allKeywords.length}个关键词)`);
      } else {
        skippedCount++;
        console.log(`⚠️  跳过: ${intentName} (未找到优化配置)`);
      }
    }

    console.log(`\n📊 优化完成统计:`);
    console.log(`✅ 已优化: ${updatedCount} 个核心意图`);
    console.log(`⚠️  跳过: ${skippedCount} 个核心意图`);
    console.log(`📈 关键词覆盖率: ${((updatedCount / coreIntents.length) * 100).toFixed(1)}%`);

    // 验证优化结果
    console.log(`\n🔍 验证优化结果:`);
    const sampleIntents = await db.CoreIntent.findAll({
      where: { categoryId: 1 },
      limit: 3,
      order: [['id', 'ASC']]
    });

    sampleIntents.forEach(intent => {
      const keywords = JSON.parse(intent.keywords);
      console.log(`\n${intent.name}:`);
      console.log(`  关键词数量: ${keywords.length}`);
      console.log(`  关键词示例: ${keywords.slice(0, 5).join(', ')}...`);
    });

    console.log(`\n🎉 关键词优化完成！`);
    console.log(`💡 建议:`);
    console.log(`1. 定期分析用户查询日志，持续优化关键词`);
    console.log(`2. 根据识别准确率调整关键词权重`);
    console.log(`3. 考虑添加同义词和近义词扩展`);
    console.log(`4. 针对高频查询优化关键词匹配`);

  } catch (error) {
    console.error('❌ 关键词优化失败:', error);
    throw error;
  }
}

// 如果直接运行此脚本
if (require.main === module) {
  optimizeKeywords()
    .then(() => {
      console.log('✅ 关键词优化完成');
      process.exit(0);
    })
    .catch(error => {
      console.error('❌ 关键词优化失败:', error);
      process.exit(1);
    });
}

module.exports = optimizeKeywords; 